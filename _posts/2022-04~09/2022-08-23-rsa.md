---
layout: post
title:  "RSA"
date:  2022-08-21
tags: [note]
use_math: true
---

RSA Algorithem


# 欧拉函数

> 任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？） from 阮一峰

$$
\phi(n) =
\begin{cases}
  1&(n = 1)
  \\n-1&(n是质数)
  \\p^k - p^{k-1}&(n是某个质数的次方，p为质数 prime 的简写)
  \\\phi(p1)\phi(p2)&(n为两个互质整数之积)
\end{cases}
$$


其中在 [阮一峰](https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html) 的第三种 case 有错误：

$$
\phi(p^k) = p^k - p^{(k-1)}
$$

当一个数不包含质数 p，才能与 n 互质。而包含质数 p 的数一共有 $p^{k-1}$ 个，分别是

$1$, $1 \times p$, $2 \times p$, $(p^{k-1} - 1) \times p$

最后那个 $(p^{k-1} \times p)$ 是 $p^k$ 本身，不应该包含，而第一个 $1$ 需要包含进去。所以，一共有 $(p^{k-1}-1) + 1 = p^{k-1}$ 个。


### 分解质因数

有了以上的相关前提条件之后，根据 [算术基本定理](https://baike.baidu.com/item/%E7%AE%97%E6%9C%AF%E5%9F%BA%E6%9C%AC%E5%AE%9A%E7%90%86/10920095) 就能得到一般公式。

$$
n = p_1^{k_1}p_2^{k_2}p_3^{k_3}...p_n^{k_r}

\Rightarrow \phi(n) = \phi(p_1^{k_1})\phi(p_2^{k_2})...\phi(p_r^{k_r})
\\
\because \phi(p^k) = p^k - p^{k-1} = p^k( 1 - \frac{1}{p})
\\
\therefore \phi(n) = p_1^{k_1} p_2^{k_2} ... p_r^{k_r} (1 - \frac{1}{p_1})(1 - \frac{1}{p_2})...(1 - \frac{1}{p_r})

\\

\Rightarrow \phi(n) = n(1 - \frac{1}{p_1})(1 - \frac{1}{p_2})...(1 - \frac{1}{p_r})
$$

Example:

$$
\phi(1323) = \phi(3^3 \times 7 ^ 2) = 1323(1 - \frac{1}{3})(1 - \frac{1}{7}) = 756
$$

### 欧拉函数速查表

![image](https://user-images.githubusercontent.com/7157346/186063336-055de6d3-3663-46ba-9c75-73df6d4e0df6.png)



# References

* Symbols: https://kapeli.com/cheat_sheets/LaTeX_Math_Symbols.docset/Contents/Resources/Documents/index
* Math Cheat Sheet: https://jojozhuang.github.io/tutorial/mathjax-cheat-sheet-for-mathematical-notation/
* RSA part one: https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html
